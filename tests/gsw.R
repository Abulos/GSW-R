library(gsw)

## gsw_specvol()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
CT <- c(28.8099, 28.4392, 22.7862, 10.2262,  6.8272,  4.3236)
p <- c(      10,      50,     125,     250,     600,    1000)
specvol <- gsw_specvol(SA, CT, p)
expect_equal(specvol, 1e-3 * c(0.978626363206202, 0.978221861206179, 0.976154716658432,
                                      0.972960929615236, 0.971026743358570, 0.968990291993136))

## gsw_specvol_anom()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
CT <- c(28.8099, 28.4392, 22.7862, 10.2262,  6.8272,  4.3236)
p <- c(      10,      50,     125,     250,     600,    1000)
a <- gsw_specvol_anom(SA, CT, p)
expect_equal(a, 1e-5 * c(0.601005694856401, 0.578559312084076, 0.405540722918385,
                                0.142144553233903, 0.104304693754049, 0.076366488048843))

## gsw_specvol_t_exact()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
t <- c( 28.7856, 28.4329, 22.8103, 10.2600,  6.8863,  4.4036)
p <- c(      10,      50,     125,     250,     600,    1000)
v <- gsw_specvol_t_exact(SA, t, p)
expect_equal(v, 1e-3 * c(0.978626625025472, 0.978222143734527, 0.976154768597586,
                                0.972961211575438, 0.971026779948624, 0.968989990731808))

## gsw_SP_from_C()
SP <- gsw_SP_from_C(34.5487, 28.7856, 10)
expect_equal(SP, 20.009869599086951))

## gsw_SP_from_SA()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
p <- c(      10,      50,     125,     250,     600,    1000)
latitude <- 4
longitude <- 188
SP <- gsw_SP_from_SA(SA, p, longitude, latitude)
expect_equal(SP, c(34.548721553448317, 34.727477488096639, 34.860554877708005,
                          34.680971112271791, 34.567971663653388, 34.560036751118204))

## gsw_SP_from_SK()
SK <- c(34.5487, 34.7275, 34.8605, 34.6810, 34.5680, 34.5600)
SP <- gsw_SP_from_SK(SK)
expect_equal(SP, c(34.548342096952908, 34.727295637119113, 34.860409847645435,
                          34.680755706371187, 34.567658670360110, 34.559651800554022))

## gsw_SP_from_SR()
SR <- c(34.5487, 34.7275, 34.8605, 34.6810, 34.5680, 34.5600)
SP <- gsw_SP_from_SR(SR)
expect_equal(SP, c(34.386552667080714, 34.564513505458834, 34.696889296869848,
                          34.518231743800094, 34.405762086435850, 34.397799632817147))

## gsw_SP_from_Sstar()
Sstar <- c(34.7115, 34.8912, 35.0247, 34.8436, 34.7291, 34.7197)
p <- c(         10,      50,     125,     250,     600,    1000)
longitude <- 188
latitude <- 4
SP <- gsw_SP_from_Sstar(Sstar, p, longitude, latitude)
expect_equal(SP, c(34.548646570969929, 34.727538423586189, 34.860549501859502,
                          34.681006826476434, 34.568065697992346, 34.560023926979518)) 

## gsw_sound_speed()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
CT <- c(28.7856, 28.4329, 22.8103, 10.2600,  6.8863,  4.4036)
p <- c(      10,      50,     125,     250,     600,    1000)
ss <- gsw_sound_speed(SA, CT, p)
expect_equal(ss, c(1542.420534932182, 1542.561816671942, 1530.847504375638,
                          1494.624012692069, 1487.691791461714, 1484.329368325987)) 

## gsw_sound_speed_t_exact()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
t <- c(28.7856, 28.4329, 22.8103, 10.2600,  6.8863,  4.4036)
p <- c(      10,      50,     125,     250,     600,    1000)
ss <- gsw_sound_speed_t_exact(SA, t, p)
expect_equal(ss, c(1542.615803587414, 1542.703534065789, 1530.844979136360,
                          1494.409996920661, 1487.377102518027, 1483.934609078705))
## gsw_Sstar_from_SA()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
p <- c(      10,      50,     125,     250,     600,    1000)
longitude <- 188
latitude <- 4
Sstar <- gsw_Sstar_from_SA(SA, p, longitude, latitude)
expect_equal.numeric(Sstar, c(34.711575335926490, 34.891138777337822, 35.024705401162166,
                                     34.843564118358302, 34.729005527604883, 34.719712883389462))

## gsw_Sstar_from_SP()
SP <- c(34.5487, 34.7275, 34.8605, 34.6810, 34.5680, 34.5600)
p <- c(      10,      50,     125,     250,     600,    1000)
longitude <- 188
latitude <- 4
Sstar <- gsw_Sstar_from_SP(SP, p, longitude, latitude)
expect_equal.numeric(Sstar, c(34.711553680880769, 34.891161395333754, 35.024650265047370,
                                     34.843593141519356, 34.729033995955525, 34.719675962471783)) 

## gsw_t_freezing()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
p <- c(      10,      50,     125,     250,     600,    1000)
saturation_fraction <- 1
tf <- gsw_t_freezing(SA, p, saturation_fraction)
warning("gsw_t_freezing() test values are from gsw_t_freezing_poly()\n")
expect_equal(tf, c(-1.902704434299200, -1.942897945475226, -2.006877364578649,
                          -2.091041391538033, -2.351431560178946, -2.660685237633709))

## gsw_t_from_CT()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
CT <- c(28.8099, 28.4392, 22.7862, 10.2262,  6.8272,  4.3236)
p <-  c(     10,      50,     125,     250,     600,    1000)
t <- gsw_t_from_CT(SA, CT, p)
expect_equal(t, c(28.785580227725703, 28.432872246163946, 22.810323087627076,
                         10.260010752788906, 6.886286301029376, 4.403624452383043))

## gsw_thermobarbaric()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
CT <- c(28.8099, 28.4392, 22.7862, 10.2262,  6.8272,  4.3236)
p <-  c(     10,      50,     125,     250,     600,    1000)
tb <- gsw_thermobaric(SA, CT, p)
expect_equal(tb, 1e-11 * c(0.140572143831373, 0.141670674489603, 0.163021073914596,
                                  0.225896125166222, 0.246017471421262, 0.261310958174722))

## gsw_Turner_Rsubrho
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
CT <- c(28.8099, 28.4392, 22.7862, 10.2262,  6.8272,  4.3236)
p <-  c(     10,      50,     125,     250,     600,    1000)
r <- gsw_Turner_Rsubrho(SA, CT, p)
expect_equal(r$Tu, c(-2.064830032393999, 41.758285540907067, 47.607293931126598,
                            53.714708172363480, 45.527415163693554))
expect_equal(r$Rsubrho, 100*c(-0.009304018848608, -0.176556664605209, 0.219600192807469,
                                     0.065238283043563, 1.086319945640579))
expect_equal(r$p_mid, 100*c(0.300000000000000, 0.875000000000000, 1.875000000000000,
                                   4.250000000000000, 8.000000000000000))

## gsw_z_from_p()
z <- gsw_z_from_p(10, 4)
expect_equal(z, -9.9445831334188)
