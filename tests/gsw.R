library(gsw)

## gsw_t_freezing()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
p <- c(      10,      50,     125,     250,     600,    1000)
saturation_fraction <- 1
tf <- gsw_t_freezing(SA, p, saturation_fraction)
warning("gsw_t_freezing() test values are from gsw_t_freezing_poly()\n")
expect_equal(tf, c(-1.902704434299200, -1.942897945475226, -2.006877364578649,
                          -2.091041391538033, -2.351431560178946, -2.660685237633709))

## gsw_t_from_CT()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
CT <- c(28.8099, 28.4392, 22.7862, 10.2262,  6.8272,  4.3236)
p <-  c(     10,      50,     125,     250,     600,    1000)
t <- gsw_t_from_CT(SA, CT, p)
expect_equal(t, c(28.785580227725703, 28.432872246163946, 22.810323087627076,
                         10.260010752788906, 6.886286301029376, 4.403624452383043))

## gsw_thermobarbaric()
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
CT <- c(28.8099, 28.4392, 22.7862, 10.2262,  6.8272,  4.3236)
p <-  c(     10,      50,     125,     250,     600,    1000)
tb <- gsw_thermobaric(SA, CT, p)
expect_equal(tb, 1e-11 * c(0.140572143831373, 0.141670674489603, 0.163021073914596,
                                  0.225896125166222, 0.246017471421262, 0.261310958174722))

## gsw_Turner_Rsubrho
SA <- c(34.7118, 34.8915, 35.0256, 34.8472, 34.7366, 34.7324)
CT <- c(28.8099, 28.4392, 22.7862, 10.2262,  6.8272,  4.3236)
p <-  c(     10,      50,     125,     250,     600,    1000)
r <- gsw_Turner_Rsubrho(SA, CT, p)
expect_equal(r$Tu, c(-2.064830032393999, 41.758285540907067, 47.607293931126598,
                            53.714708172363480, 45.527415163693554))
expect_equal(r$Rsubrho, 100*c(-0.009304018848608, -0.176556664605209, 0.219600192807469,
                                     0.065238283043563, 1.086319945640579))
expect_equal(r$p_mid, 100*c(0.300000000000000, 0.875000000000000, 1.875000000000000,
                                   4.250000000000000, 8.000000000000000))

## gsw_z_from_p()
z <- gsw_z_from_p(10, 4)
expect_equal(z, -9.9445831334188)
